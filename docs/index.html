<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2023-12-17 Sun 19:08 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="author" content="Harish Narayanan" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
</head>
<body>
<div id="content" class="content">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orga4f59ae">1. Django Extensible Models</a></li>
<li><a href="#orgca130de">2. Features</a>
<ul>
<li><a href="#orge6407cb">2.1. It's easy to incrementally add this to your app</a></li>
<li><a href="#orgd9a14c4">2.2. Formal schema for extended fields</a></li>
<li><a href="#orga602968">2.3. Different extended schema for different groups of objects</a></li>
<li><a href="#orgeb7743f">2.4. Strong validation of data for these extended fields</a></li>
<li><a href="#org8931cc5">2.5. Ability to query these fields using an ORM-friendly syntax</a></li>
<li><a href="#orgff6ae02">2.6. <span class="todo TODO">TODO</span> Dynamically generated forms for these extended fields in the Django Admin interface</a></li>
<li><a href="#org07a08aa">2.7. <span class="done DONE">DONE</span> Dynamic extensions for these fields in Django Model Forms (and Crispy Forms)</a></li>
<li><a href="#orgb3828d4">2.8. <span class="todo TODO">TODO</span> Dynamic extensions for these fields in for Django Rest Framework</a></li>
<li><a href="#orgf2002af">2.9. <span class="todo TODO">TODO</span> Dynamic extensions for these fields in Django (Rest Framework) Filters</a></li>
<li><a href="#orgf65dfdd">2.10. <span class="todo TODO">TODO</span> Migrations between versions of your extended schema!</a></li>
</ul>
</li>
<li><a href="#orgb39a02f">3. <span class="todo TODO">TODO</span> Installation</a></li>
<li><a href="#usage">4. Usage</a>
<ul>
<li><a href="#org5e8c0bd">4.1. Basic Usage</a></li>
<li><a href="#org6998624">4.2. Advanced Usage</a></li>
</ul>
</li>
<li><a href="#org08e6d39">5. How does it work?</a></li>
<li><a href="#org9f6a158">6. Copyright and License</a></li>
</ul>
</div>
</div>
<div id="outline-container-orga4f59ae" class="outline-2">
<h2 id="orga4f59ae"><span class="section-number-2">1.</span> Django Extensible Models</h2>
<div class="outline-text-2" id="text-1">
<p>
Django offers a really robust model system that functions as a great
interface to store and retrieve data related to your app. Models in
Django are backed by tables in a relational database. While this is
really good for correctness, it is quite rigid in terms of the shape
of data that is stored. Sometimes, you run into use-cases that demand
a bit more dynamism during the running of your Django app.
</p>

<p>
Let's take a concrete example. You have an existing Django SaaS app
that's launched to many happy customers. They are happy, but each
customer feels that if they could store <i>just a little bit more custom
data</i> as part of their usage of your app, their workflows would be
much smoother. So they ask you to add what they want. The trouble is,
each customer is interested in augmenting their data in different
ways. You diligently add the first customer's fields. And then
another's. And then even more. And before you know it, things get
really messy.
</p>

<p>
Solving this problem is the point of this project. Instead of
individually catering to each of their requests, <i>Django Extensible
Models</i> offers you a general extension mechanism that allows your models
to grow with your customers' needs.
</p>
</div>
</div>

<div id="outline-container-orgca130de" class="outline-2">
<h2 id="orgca130de"><span class="section-number-2">2.</span> Features</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orge6407cb" class="outline-3">
<h3 id="orge6407cb"><span class="section-number-3">2.1.</span> It's easy to incrementally add this to your app</h3>
<div class="outline-text-3" id="text-2-1">
<p>
With a relatively small change to your existing model code (see
<a href="#usage">Usage</a>), you now have a Django model that retains all its Django
goodness, and can be extended on the fly with additional fields at
runtime.
</p>
</div>
</div>

<div id="outline-container-orgd9a14c4" class="outline-3">
<h3 id="orgd9a14c4"><span class="section-number-3">2.2.</span> Formal schema for extended fields</h3>
<div class="outline-text-3" id="text-2-2">
<p>
We don't just stuff the extra data for these additional fields into a
<code>JSONField</code> and call it a day,<sup><a id="fnr.1" class="footref" href="#fn.1" role="doc-backlink">1</a></sup> we allow you to define a proper schema for this data (using
<a href="https://jsonschema.net">JSON Schema</a>).
</p>
</div>
</div>

<div id="outline-container-orga602968" class="outline-3">
<h3 id="orga602968"><span class="section-number-3">2.3.</span> Different extended schema for different groups of objects</h3>
<div class="outline-text-3" id="text-2-3">
<p>
It wouldn't make much sense to apply the same extension schema to all
objects of your model,<sup><a id="fnr.2" class="footref" href="#fn.2" role="doc-backlink">2</a></sup> so Django Extensible Models allows you to define
different extended fields for different sets of objects.
</p>

<p>
We also allow you to extended individual objects in unique ways if
that is what you need.
</p>
</div>
</div>

<div id="outline-container-orgeb7743f" class="outline-3">
<h3 id="orgeb7743f"><span class="section-number-3">2.4.</span> Strong validation of data for these extended fields</h3>
<div class="outline-text-3" id="text-2-4">
<p>
With a good schema defined, it is easy to validate that incoming data
for your extended fields match your expectations before storing it in
the database.
</p>
</div>
</div>

<div id="outline-container-org8931cc5" class="outline-3">
<h3 id="org8931cc5"><span class="section-number-3">2.5.</span> Ability to query these fields using an ORM-friendly syntax</h3>
<div class="outline-text-3" id="text-2-5">
<p>
The data for your extended fields is not simply stored in a messy,
impenetrable blob. It is stored in a structured <a href="https://docs.djangoproject.com/en/dev/ref/models/fields/#jsonfield">JSONField</a> that can be
queried in a systematic way using standard Django syntax.
</p>
</div>
</div>

<div id="outline-container-orgff6ae02" class="outline-3">
<h3 id="orgff6ae02"><span class="section-number-3">2.6.</span> <span class="todo TODO">TODO</span> Dynamically generated forms for these extended fields in the Django Admin interface</h3>
</div>
<div id="outline-container-org07a08aa" class="outline-3">
<h3 id="org07a08aa"><span class="section-number-3">2.7.</span> <span class="done DONE">DONE</span> Dynamic extensions for these fields in Django Model Forms (and Crispy Forms)</h3>
</div>
<div id="outline-container-orgb3828d4" class="outline-3">
<h3 id="orgb3828d4"><span class="section-number-3">2.8.</span> <span class="todo TODO">TODO</span> Dynamic extensions for these fields in for Django Rest Framework</h3>
</div>
<div id="outline-container-orgf2002af" class="outline-3">
<h3 id="orgf2002af"><span class="section-number-3">2.9.</span> <span class="todo TODO">TODO</span> Dynamic extensions for these fields in Django (Rest Framework) Filters</h3>
</div>

<div id="outline-container-orgf65dfdd" class="outline-3">
<h3 id="orgf65dfdd"><span class="section-number-3">2.10.</span> <span class="todo TODO">TODO</span> Migrations between versions of your extended schema!</h3>
<div class="outline-text-3" id="text-2-10">
<p>
Taken together, you should be able to use your extended fields much
like how you use your native Django model fields. And this is just
cool.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb39a02f" class="outline-2">
<h2 id="orgb39a02f"><span class="section-number-2">3.</span> <span class="todo TODO">TODO</span> Installation</h2>
</div>

<div id="outline-container-usage" class="outline-2">
<h2 id="usage"><span class="section-number-2">4.</span> Usage</h2>
<div class="outline-text-2" id="text-usage">
<p>
You download the code in this repository (by using the big green
`Code` button on this project‘s GitHub page) and navigate into it.
</p>

<p>
When in the folder, do the following:
</p>

<div class="org-src-container">
<pre class="src src-shell"><span class="org-tree-sitter-hl-faceXfunctionXcall">python</span> <span class="org-tree-sitter-hl-faceXconstant">-m</span> venv venv
<span class="org-tree-sitter-hl-faceXfunctionXcall"><span class="org-tree-sitter-hl-faceXfunctionXbuiltin">source</span></span> venv/bin/activate
<span class="org-tree-sitter-hl-faceXfunctionXcall"><span class="org-tree-sitter-hl-faceXfunctionXbuiltin">cd</span></span> src
<span class="org-tree-sitter-hl-faceXfunctionXcall">./manage.py</span> runserver
</pre>
</div>

<p>
And then go visit
<a href="http://localhost:8000/contacts/">http://localhost:8000/contacts/</a> to
see the app in practice. If you want to access the Django admin, head
to <a href="http://localhost:8000/admin/">http://localhost:8000/admin/</a> and
use the credentials `username: harish, password: harish`.
</p>
</div>

<div id="outline-container-org5e8c0bd" class="outline-3">
<h3 id="org5e8c0bd"><span class="section-number-3">4.1.</span> Basic Usage</h3>
</div>

<div id="outline-container-org6998624" class="outline-3">
<h3 id="org6998624"><span class="section-number-3">4.2.</span> Advanced Usage</h3>
</div>
</div>

<div id="outline-container-org08e6d39" class="outline-2">
<h2 id="org08e6d39"><span class="section-number-2">5.</span> How does it work?</h2>
<div class="outline-text-2" id="text-5">
<p>
The main idea is that every Model you want extended is now augmented
with two new `JSONField`s: `extra` and `extra<sub>schema</sub>`. `extra<sub>schema</sub>`
contains a schema that follows the [JSON
Schema](<a href="https://json-schema.org">https://json-schema.org</a>) specification. This is used to
auto-generate forms, handle validation, auto-generate Django Rest
Framework Serializers, &#x2026;
</p>

<p>
This idea generally handles most cases except migrations that I am
continuing to think about. If you have any ideas, do let me know.
</p>

<p>
The main idea is that every Model you want extended is now augmented
with two new `JSONField`s: `extra` and `extra<sub>schema</sub>`. `extra<sub>schema</sub>`
contains a schema that follows the [JSON
Schema](<a href="https://json-schema.org">https://json-schema.org</a>) specification. This is used to
auto-generate forms, handle validation, auto-generate Django Rest
Framework Serializers, &#x2026;
</p>
</div>
</div>

<div id="outline-container-org9f6a158" class="outline-2">
<h2 id="org9f6a158"><span class="section-number-2">6.</span> Copyright and License</h2>
<div class="outline-text-2" id="text-6">
<p>
Copyright (c) 2022-2024 <a href="https://harishnarayanan.org">Harish Narayanan</a>
</p>

<p>
This code is licenced under the MIT Licence. See <a href="https://github.com/hnarayanan/django-extensible-models-experiment/blob/main/LICENSE">LICENSE</a> for the full
text of this licence.
</p>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1" role="doc-backlink">1</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">What sort of operation do you think
this is?</p></div></div>

<div class="footdef"><sup><a id="fn.2" class="footnum" href="#fnr.2" role="doc-backlink">2</a></sup> <div class="footpara" role="doc-footnote"><p class="footpara">You could just update the Python model code
of your app instead!</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Harish Narayanan</p>
<p class="date">Created: 2023-12-17 Sun 19:08</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>